FROM node:20-alpine
WORKDIR /app
COPY package*.json ./
RUN npm ci --ignore-scripts
COPY . .
RUN sh -c 'npm run build || echo "No build script"'
EXPOSE 3000
ENTRYPOINT []
CMD ["sh", "-c", "npm start 2>/dev/null || npm run dev 2>/dev/null || node server.js 2>/dev/null || (echo 'Container ready' && tail -f /dev/null)"]